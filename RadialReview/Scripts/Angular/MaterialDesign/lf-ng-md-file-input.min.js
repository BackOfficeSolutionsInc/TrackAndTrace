(function(n){"use strict";var i=function(){return"lfobjxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})},t=n.module("lfNgMdFileInput",["ngMaterial"]);t.filter("lfTrusted",["$sce",function(n){return function(t){return n.trustAsResourceUrl(t)}}]);t.directive("lfRequired",function(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r&&(r.$validators.required=function(n){return n?n.length>0:!1})}}});t.directive("lfMaxcount",function(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){if(r){var u=-1;i.$observe("lfMaxcount",function(n){var t=parseInt(n,10);u=isNaN(t)?-1:t;r.$validate()});r.$validators.maxcount=function(n){return n?n.length<=u:!1}}}}});t.directive("lfFilesize",function(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){if(r){var u=-1;i.$observe("lfFilesize",function(n){var t=/^[1-9][0-9]*(Byte|KB|MB)$/;if(t.test(n)){var i=n.match(t)[1],f=n.substring(0,n.indexOf(i));["Byte","KB","MB"].every(function(n,t){return i===n?(u=parseInt(f)*Math.pow(1024,t),!1):!0})}else u=-1;r.$validate()});r.$validators.filesize=function(n){if(!n)return!1;var t=!0;return n.every(function(n){return n.lfFile.size>u?(t=!1,!1):!0}),t}}}}});t.directive("lfTotalsize",function(){return{restrict:"A",require:"ngModel",link:function(t,i,r,u){if(u){var f=-1;r.$observe("lfTotalsize",function(n){var t=/^[1-9][0-9]*(Byte|KB|MB)$/;if(t.test(n)){var i=n.match(t)[1],r=n.substring(0,n.indexOf(i));["Byte","KB","MB"].every(function(n,t){return i===n?(f=parseInt(r)*Math.pow(1024,t),!1):!0})}else f=-1;u.$validate()});u.$validators.totalsize=function(t){if(!t)return!1;var i=0;return n.forEach(t,function(n){i=i+n.lfFile.size}),i<f}}}}});t.directive("lfMimetype",function(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){if(r){var u;i.$observe("lfMimetype",function(n){u=new RegExp(n,"i");r.$validate()});r.$validators.mimetype=function(n){if(!n)return!1;var t=!0;return n.every(function(n){return n.lfFile.type.match(u)?!0:(t=!1,!1)}),t}}}}});t.directive("lfNgMdFileInput",["$q","$compile","$timeout",function(t,r,u){return{restrict:"E",template:['<div layout="column" class="lf-ng-md-file-input" ng-model="'+i()+'">','<div layout="column" class="lf-ng-md-file-input-preview-container" ng-class="{\'disabled\':isDisabled}" ng-show="isDrag || (isPreview && !isFilesNull)">','<div class="close lf-ng-md-file-input-x" ng-click="removeAllFiles($event)" ng-hide="isFilesNull" >&times;<\/div>','<div class="lf-ng-md-file-input-drag">','<div layout="row" layout-align="center center" class="lf-ng-md-file-input-drag-text-container" ng-show="isFilesNull && isDrag">','<div class="lf-ng-md-file-input-drag-text">{{strCaptionDragAndDrop}}<\/div>',"<\/div>",'<div class="lf-ng-md-file-input-thumbnails">',"<\/div>",'<div class="clearfix" style="clear:both"><\/div>',"<\/div>","<\/div>",'<div layout="row" class="lf-ng-md-file-input-container" >','<div class="lf-ng-md-file-input-caption" layout="row" layout-align="start center" flex ng-class="{\'disabled\':isDisabled}" >','<md-icon class="lf-icon" ng-class="strCaptionIconCls"><\/md-icon>','<div flex class="lf-ng-md-file-input-caption-text-default" ng-show="isFilesNull">',"{{strCaptionPlaceholder}}","<\/div>",'<div flex class="lf-ng-md-file-input-caption-text" ng-hide="isFilesNull">',"{{strCaption}}","<\/div>",'<md-progress-linear md-mode="determinate" value="{{floatProgress}}" ng-show="intLoading && isProgress"><\/md-progress-linear>',"<\/div>",'<md-button ng-disabled="isDisabled" ng-click="removeAllFiles()" ng-hide="isFilesNull || intLoading" class="md-raised lf-ng-md-file-input-button lf-ng-md-file-input-button-remove" >','<md-icon class="lf-icon" ng-class="strRemoveIconCls"><\/md-icon> ',"{{strCaptionRemove}}","<\/md-button>",'<md-button ng-disabled="isDisabled" ng-click="openDialog($event, this)" class="md-raised md-primary lf-ng-md-file-input-button lf-ng-md-file-input-button-brower" >','<md-icon class="lf-icon" ng-class="strBrowseIconCls"><\/md-icon> ',"{{strCaptionBrowse}}",'<input type="file" aria-label="{{strAriaLabel}}" accept="{{accept}}" ng-disabled="isDisabled" class="lf-ng-md-file-input-tag" />',"<\/md-button>","<\/div>","<\/div>"].join(""),replace:!0,require:"ngModel",scope:{lfFiles:"=?",lfApi:"=?",lfOption:"=?",lfCaption:"@?",lfPlaceholder:"@?",lfDragAndDropLabel:"@?",lfBrowseLabel:"@?",lfRemoveLabel:"@?",accept:"@?",ngDisabled:"=?"},link:function(i,f,e,o){var c=n.element(f[0].querySelector(".lf-ng-md-file-input-tag")),h=n.element(f[0].querySelector(".lf-ng-md-file-input-drag")),y=n.element(f[0].querySelector(".lf-ng-md-file-input-thumbnails")),l=!1,s=0;i.intLoading=0;i.floatProgress=0;i.isPreview=!1;i.isDrag=!1;i.isMutiple=!1;i.isProgress=!1;n.isDefined(e.preview)&&(i.isPreview=!0);n.isDefined(e.drag)&&(i.isDrag=!0);n.isDefined(e.multiple)?(c.attr("multiple","multiple"),i.isMutiple=!0):c.removeAttr("multiple");n.isDefined(e.progress)&&(i.isProgress=!0);i.isDisabled=!1;n.isDefined(e.ngDisabled)&&i.$watch("ngDisabled",function(n){i.isDisabled=n});i.strBrowseIconCls="lf-browse";i.strRemoveIconCls="lf-remove";i.strCaptionIconCls="lf-caption";i.strUnknowIconCls="lf-unknow";n.isDefined(e.lfOption)&&n.isObject(i.lfOption)&&(i.lfOption.hasOwnProperty("browseIconCls")&&(i.strBrowseIconCls=i.lfOption.browseIconCls),i.lfOption.hasOwnProperty("removeIconCls")&&(i.strRemoveIconCls=i.lfOption.removeIconCls),i.lfOption.hasOwnProperty("captionIconCls")&&(i.strCaptionIconCls=i.lfOption.captionIconCls),i.lfOption.hasOwnProperty("unknowIconCls")&&(i.strUnknowIconCls=i.lfOption.unknowIconCls));i.accept=i.accept||"";i.lfFiles=[];i[e.ngModel]=i.lfFiles;i.$watch("lfFiles.length",function(){o.$validate()});i.lfApi=new function(){var n=this;n.removeAll=function(){i.removeAllFiles()}};i.isFilesNull=!0;i.strCaption="";i.strCaptionPlaceholder="Select file";i.strCaptionDragAndDrop="Drag & drop files here...";i.strCaptionBrowse="Browse";i.strCaptionRemove="Remove";i.strAriaLabel="";n.isDefined(e.ariaLabel)&&(i.strAriaLabel=e.ariaLabel);n.isDefined(e.lfPlaceholder)&&i.$watch("lfPlaceholder",function(n){i.strCaptionPlaceholder=n});n.isDefined(e.lfCaption)&&(l=!0,i.$watch("lfCaption",function(n){i.strCaption=n}));i.lfDragAndDropLabel&&(i.strCaptionDragAndDrop=i.lfDragAndDropLabel);i.lfBrowseLabel&&(i.strCaptionBrowse=i.lfBrowseLabel);i.lfRemoveLabel&&(i.strCaptionRemove=i.lfRemoveLabel);h.bind("dragover",function(n){(n.stopPropagation(),n.preventDefault(),!i.isDisabled&&i.isDrag)&&h.addClass("lf-ng-md-file-input-drag-hover")});h.bind("dragleave",function(n){(n.stopPropagation(),n.preventDefault(),!i.isDisabled&&i.isDrag)&&h.removeClass("lf-ng-md-file-input-drag-hover")});h.bind("drop",function(t){var f,r,u,e,o;if((t.stopPropagation(),t.preventDefault(),!i.isDisabled&&i.isDrag)&&(h.removeClass("lf-ng-md-file-input-drag-hover"),n.isObject(t.originalEvent)&&(t=t.originalEvent),f=t.target.files||t.dataTransfer.files,r=0,!(f.length<=0)))if(e=i.lfFiles.map(function(n){return n.lfFileName}),o=new RegExp(i.accept,"i"),i.floatProgress=0,i.isMutiple)for(s=f.length,r=0;r<f.length;r++)u=f[r],u.type.match(o)&&e.indexOf(u.name)==-1&&setTimeout(a(u),r*100);else for(s=1,r=0;r<f.length;r++)if(u=f[r],u.type.match(o)&&e.indexOf(u.name)==-1){i.removeAllFiles();setTimeout(a(u),r*100);break}});i.openDialog=function(n){n&&u(function(){n.preventDefault();n.stopPropagation();var t=n.target.children[2];t!==undefined&&t.click()},0)};i.removeAllFiles=function(){i.isDisabled||(i.lfFiles.length=0,y.empty(),v())};i.removeFileByName=function(t,r){i.isDisabled||(i.lfFiles.every(function(n,r){return n.lfFileName==t?(i.lfFiles.splice(r,1),!1):!0}),r&&n.element(r.target).parent().remove(),v())};i.onFileChanged=function(n){var r=n.files||n.target.files,e=i.lfFiles.map(function(n){return n.lfFileName}),f,t,u;if(!(r.length<=0)){if(i.floatProgress=0,i.isMutiple)for(s=r.length,t=0;t<r.length;t++)u=r[t],f=1,e.indexOf(u.name)==-1&&(setTimeout(a(u),f*100),f++);else for(s=1,t=0;t<r.length;t++)if(u=r[t],e.indexOf(u.name)==-1){i.removeAllFiles();setTimeout(a(u),100);break}c.val("")}};c.bind("change",i.onFileChanged);var a=function(t){i.intLoading++;d(t).then(function(){var e=t,a=t.name,o=t.type,s=p(t),u=window.URL.createObjectURL(t),c,l;i.lfFiles.push({lfFile:e,lfFileName:a,lfDataUrl:u});var f=n.element('<div class="lf-ng-md-file-input-frame"><\/div>'),w=n.element('<div class="lf-ng-md-file-input-x" ng-click="removeFileByName(\''+t.name+"',$event)\">&times;<\/div>"),h="";h=s=="image"?'<img src="'+u+'" >':s=="video"?["<video controls>",'<source src="'+u+'" type="'+o+'">',"<\/video>"].join(""):s=="audio"?["<audio controls>",'<source src="'+u+'" type="'+o+'">',"<\/audio>"].join(""):['<object data="'+u+'" type="'+o+'"><param name="movie" value="'+e.name+'" />','<div class="lf-ng-md-file-input-preview-default">','<md-icon class="lf-ng-md-file-input-preview-icon" ng-class="strUnknowIconCls"><\/md-icon>',"<\/div>","<\/object>"].join("");c=n.element(h);l=n.element('<div class="lf-ng-md-file-input-frame-footer"><div class="lf-ng-md-file-input-frame-caption">'+e.name+"<\/div><\/div>");f.append(w);f.append(c);f.append(l);r(f)(i);y.append(f);v()},function(){},function(){})},v=function(){i.lfFiles.length==1?(l||(i.strCaption=""+i.lfFiles[0].lfFileName),i.isFilesNull=!1):i.lfFiles.length>1?(l||(i.strCaption=""+i.lfFiles.length+" files selected"),i.isFilesNull=!1):(l||(i.strCaption=""),i.isFilesNull=!0)},p=function(n){var t=n.type,i=n.name;return w(t,i)?"image":b(t,i)?"video":k(t,i)?"audio":"object"},w=function(n,t){return n.match("image.*")||t.match(/\.(gif|png|jpe?g)$/i)?!0:!1},b=function(n,t){return n.match("video.*")||t.match(/\.(og?|mp4|webm|3gp)$/i)?!0:!1},k=function(n,t){return n.match("audio.*")||t.match(/\.(ogg|mp3|wav)$/i)?!0:!1},d=function(n,r){var f=t.defer(),u=new FileReader;return u.onloadstart=function(){f.notify(0)},u.onload=function(){},u.onloadend=function(){f.resolve({index:r,result:u.result});i.intLoading--;i.floatProgress=(s-i.intLoading)/s*100},u.onerror=function(){f.reject(u.result);i.intLoading--;i.floatProgress=(s-i.intLoading)/s*100},u.onprogress=function(n){f.notify(n.loaded/n.total)},u.readAsArrayBuffer(n),f.promise}}}}])})(window.angular);
//# sourceMappingURL=lf-ng-md-file-input.min.js.map
