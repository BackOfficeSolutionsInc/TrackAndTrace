@{
	var headers = (ViewBag.AddHeaders == null || ((bool)ViewBag.AddHeaders) == true);
	var controller = (ViewBag.AddController != null && ((bool)ViewBag.AddController) == true);
	var completion = (ViewBag.AddCompletion == null || ((bool)ViewBag.AddCompletion) == true);
	var datepicker = (ViewBag.AddDatePicker == null || ((bool)ViewBag.AddDatePicker) == true);
}
<div @(headers ? "ng-app=L10App" : "") class="meeting-review ng-cloak todo-list-container app">
	<div @(headers || controller ? "ng-controller=L10Controller" : "")>
		<div class="row">
			<div class="col-md-12">
				<div class="pull-left name"><h3 style="margin-top: 5px;">{{model.Name}}</h3></div>
				@if (datepicker)
				{
					<div class="calendar-container pull-right clearfix" style="width: 240px;">
						<i class="glyphicon glyphicon-calendar fa fa-calendar"></i>
						<input date-range-picker id="daterange3" class="form-control date-picker" type="text" name="date" ng-model="date" options="opts" required placeholder="Select a date range..." />
						<b class="caret"></b>
					</div>
					<div class="height-placeholder" style="height:40px"></div>
				}
				<div id="Todo" class="tab-pane todo-pane scrollbox pull-left">
					<div></div>
					<div ng-repeat="(key,value) in model.Todos | transform:this | groupBy: 'Owner.Name' ">
						<table width="100%" class="component table-hover" ng-show="(value | filter:filters.byRange('CompleteTime',model.date.startDate,model.date.endDate)).length">
							<thead>
								<tr class="table-header" ng-show="$first">
									<th></th>
									<th class="picture-column"></th>
									<th>To-Do</th>
									<th class="alignCenter hidden-width-1">Due Date</th>
									<th class="empty-cell"></th>
									@if (completion)
									{
										<th class="hidden-width-1">Completed</th>
									}
								</tr>
							</thead>
							@*| orderBy: ['Complete','-CompleteTime','Name']*@
							<tbody>
								<tr id="todo_{{todo.Id}}"  @*'Complete','-CompleteTime','DueDate'*@
									ng-repeat-start="todo in value | orderBy: ['DueDate'] | filter:filters.byRange('CompleteTime',model.date.startDate,model.date.endDate) track by $index"
									ng-class="{grayRow: todo.Complete}"
									ng-hide="model.Selected==todo.Key"
									class="clickable">
									<td class="todo-checkbox-container" style="min-width: 25px;text-align: center;">
										<input type="checkbox" ng-model="todo.Complete" ng-change="functions.updateComplete(this);functions.sendUpdate(todo)" />
									</td>
									<td class="picture-column"><profile-image user="todo.Owner"></profile-image></td>
									<td class="todo-text" style="width:100%" ng-click="model.Selected = todo.Key">{{todo.Name}}</td>
									<td class="alignCenter hidden-width-1" style="min-width: 85px;vertical-align: top;"><input ng-class="todo.Complete?(''):(todo.DueDate>now? 'green' : 'red')" class="due-date" data-todo="{{todo.Id}}" type="text" value="{{todo.DueDate | date:'MM/dd/yyyy'}}" /></td>
									<td class="empty-cell" style="min-width: 15px;"></td>
									@if (completion)
									{
										<td class="alignCenter" style="min-width: 75px;">{{todo.CompleteTime | date:'MM/dd/yy'}}</td>
									}
								</tr>
								<tr id="todo_{{todo.Id}}" ng-show="model.Selected==todo.Key" ng-class="{grayRow: todo.Complete}">
									<td style="min-width: 25px;text-align: center;"><input type="checkbox" ng-model="todo.Complete" ng-change="functions.updateComplete(this);functions.sendUpdate(todo)" /></td>
									<td class="picture-column"><profile-image user="todo.Owner"></profile-image></td>
									<td style="width:100%" class="todo-text">
										<input ng-model-options="{debounce: 200}" type="text" ng-model="todo.Name" class="fullWidth" ng-change="functions.sendUpdate(todo)" />
									</td>
									<td class="alignCenter hidden-width-1" style="min-width: 85px;vertical-align: top;"><input class="due-date" data-todo="{{todo.Id}}" type="text" value="{{todo.DueDate | date:'MM/dd/yyyy'}}" /></td>
									<td class="empty-cell" style="min-width: 15px;"></td>
									@if (completion)
									{
										<td class="alignCenter hidden-width-1" style="min-width: 75px;">{{todo.CompleteTime | date:'MM/dd/yy'}}</td>
									}
								</tr>
								<tr ng-repeat-end style="color:gray" ng-show="model.Selected==todo.Key" ng-class="{grayRow: todo.Complete}">
									<td></td>
									<td class="picture-column"></td>
									<td><textarea ng-model-options="{debounce: 200}" class="fullWidth verticalOnly" ng-model="todo.Details" placeholder="Enter to-do details..." style="min-height: 100px;" ng-change="functions.sendUpdate(todo)"></textarea></td>
									<td class="hidden-width-1 alignCenter gray" style="vertical-align: top;">
										<a class="" ng-show="todo.Link!=null" target="_blank" href="{{todo.Link}}"><span class="glyphicon glyphicon-comment"></span></a>
									</td>
									<td class="empty-cell"></td>
									@if (completion)
									{
										<td class="hidden-width-1"></td>
									}
								</tr>
							</tbody>
						</table>
					</div>
					<div class="gray no-todos" style="padding: 30px 15px;" ng-show="(model.Todos | transform:this | filter:filters.byRange('CompleteTime',model.date.startDate,model.date.endDate)).length==0">
						No to-dos fit your search criteria.
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
